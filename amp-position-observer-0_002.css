(self.AMP=self.AMP||[]).push({m:0,v:"2111060251003",n:"amp-position-observer",ev:"0.1",l:true,f:function(AMP,_){"use strict";var aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function ba(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],d=0;d<b.length;++d){var c=b[d];if(c&&c.Math==Math)return}(function(){throw Error("Cannot find global object")})()}ba(this);"function"===typeof Symbol&&Symbol("x");var k;if("function"==typeof Object.setPrototypeOf)k=Object.setPrototypeOf;else{var m;a:{var ca={a:!0};try{n.__proto__=ca;m=n.a;break a}m=!1}k=m?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var p=k;function da(a,b){for(var d=[],c=0,f=0;f<a.length;f++){var e=a[f];b(e,f,a)?d.push(e):(c<f&&(a[c]=e),c++)}c<a.length&&(a.length=c);return d}function q(a){return a||{}}function ea(a){return 1==(null==a?void 0:a.nodeType)?a.tagName.toLowerCase()+(a.id?"#"+a.id:""):a}function fa(a,b,d,c){var f=void 0===d?"Assertion failed":d;if(b)return b;a&&-1==f.indexOf(a)&&(f+=a);for(var e=3,g=f.split("%s"),h=g.shift(),l=[h];g.length;){var E=arguments[e++],F=g.shift();h+=ea(E)+F;l.push(E,F.trim())}e=Error(h);e.messageArray=da(l,(function(ia){return""!==ia}));var G,H;null==(H=(G=self).__AMP_REPORT_ERROR)||H.call(G,e);throw e}function r(a,b,d){return fa("​​​",a,b,d,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}function t(a){r(/^\d+(\.\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)$/.test(a),"Invalid length value: %s",a);return a}function u(a,b,d,c){return{left:a,top:b,width:d,height:c,bottom:b+c,right:a+d,x:a,y:b}}function v(a,b){return a.top<b.top?"top":a.bottom>b.bottom?"bottom":"inside"}function w(a,b){return a&&b?a.left==b.left&&a.top==b.top&&a.width==b.width&&a.height==b.height:!1},ha=("string"==typeof x.cdnProxyRegex?new RegExp(x.cdnProxyRegex):x.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function y(a){if(self.document&&self.document.head&&(!self.location||!ha.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}x.cdnUrl||y("runtime-host");x.geoApiUrl||y("amp-geo-api");function ja(a,b){function d(){c=0;var g=500-(a.Date.now()-f);if(0<g)c=a.setTimeout(d,g);else{var h=e;e=null;b.apply(null,h)}}var c=0,f=0,e=null;return function(g){for(var h=[],l=0;l<arguments.length;++l)h[l-0]=arguments[l];f=a.Date.now();e=h;c||(c=a.setTimeout(d,500))}}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var z=self.__AMP_LOG;function A(){throw Error("failed to call initLogConstructor")}function B(){z.user||(z.user=A());return z.user}function C(a,b){B().assert(a,b,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}function ka(a){var b=D,d=I(a),c=J(d),f=K(c),e=f["position-observer"];e||(e=f["position-observer"]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1});e.ctor||(e.ctor=b,e.context=d,e.sharedInstance=!1,e.resolve&&L(c,"position-observer"))}function M(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return L(a,b)}function N(a,b){var d=I(a);d=J(d);return L(d,b)}function la(a){a=I(a);a=J(a);return O(a,"action")?L(a,"action"):null}function I(a){return a.nodeType?M((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function J(a){a=I(a);return a.isSingleDoc()?a.win:a}function L(a,b){O(a,b);a=K(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function K(a){var b=a.__AMP_SERVICES;);return b}function O(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor)}function P(a,b,d,c){this.element=b;this.T=c;this.fidelity=d;this.turn=0==d?Math.floor(4*Math.random()):0;this.F=null;this.j=N(a,"viewport")}P.prototype.update=function(a){var b=this;if(!a){if(0!=this.turn){this.turn--;return}0==this.fidelity&&(this.turn=4)}var d=this.j.getSize(),c=u(0,0,d.width,d.height);this.j.getClientRectAsync(this.element).then((function(f){var e={positionRect:f,viewportRect:c,relativePos:null},g=b.F;if(!(g&&w(g.positionRect,e.positionRect)&&w(g.viewportRect,e.viewportRect))){g=e.positionRect;e.relativePos=v(g,e.viewportRect);var h=e.viewportRect;g.top<=h.bottom&&h.top<=g.bottom&&g.left<=h.right&&h.left<=g.right?(b.F=e,b.T(e)):b.F&&(b.F=null,e.positionRect=null,b.T(e))}}))};function D(a){var b=this;this.Y=a;this.X=a.win;this.h=[];this.ba=M(this.X,"vsync");this.j=N(a,"viewport");this.K=[];this.N=this.P=this.O=!1;this.Z=ja(this.X,(function(){b.O=!1}))}D.prototype.observe=function(a,b,d){var c=this,f=new P(this.Y,a,b,d);this.h.push(f);this.N||ma(this);f.update();return function(){for(var e=0;e<c.h.length;e++)if(c.h[e]==f){c.h.splice(e,1);0==c.h.length&&Q(c);break}}};D.prototype.unobserve=function(a){for(var b=0;b<this.h.length;b++)if(this.h[b].element==a){this.h.splice(b,1);0==this.h.length&&Q(this);return}(z.dev||(z.dev=A())).error("POSITION_OBSERVER","cannot unobserve unobserved element")};function ma(a){a.N=!0;a.K.push(a.j.onScroll((function(){a.Z();a.O=!0;a.P||R(a)})));a.K.push(a.j.onResize((function(){a.updateAllEntries(!0)})))}function Q(a){for(a.N=!1;a.K.length;)a.K.pop()()}D.prototype.updateAllEntries=function(a){for(var b=0;b<this.h.length;b++)this.h[b].update(a)};function R(a){a.updateAllEntries();a.P=!0;a.O?a.ba.measure((function(){R(a)})):a.P=!1}function S(a,b,d){var c={detail:d};Object.assign(c,void 0);if("function"==typeof a.CustomEvent)return new a.CustomEvent(b,c);a=a.document.createEvent("CustomEvent");a.initCustomEvent(b,!!c.bubbles,!!c.cancelable,d);return a}function T(a){a=AMP.BaseElement.call(this,a)||this;a.C=null;a.A=null;a.j=null;a.o=!1;a.J=0;a.B=0;a.R="0";a.M="0";a.G=0;a.V=0;a.L=null;a.I=null;a.D=null;a.H=0;a.U=0;a.W=!1;a.S=!1;return a}var U=AMP.BaseElement;T.prototype=aa(U.prototype);T.prototype.constructor=T;if(p)p(T,U);else for(var V in U)if("prototype"!=V)if(Object.defineProperties){var W=Object.getOwnPropertyDescriptor(U,V);W&&Object.defineProperty(T,V,W)}else T[V]=U[V];T.da=U.prototype;T.prototype.buildCallback=function(){this.getAmpDoc().whenFirstVisible().then(this.$.bind(this));this.W=this.element.hasAttribute("once")};T.prototype.$=function(){var a=this;na(this);this.C=la(this.element);this.j=N(this.element,"viewport");this.A||(ka(this.getAmpDoc()),this.A=N(this.element,"position-observer"));this.getAmpDoc().whenReady().then((function(){var b=X(a);a.A.observe(b,1,a.aa.bind(a))}))};function Y(a){var b=a.j.getScrollTop(),d=q({"start-scroll-offset":b,"end-scroll-offset":b+a.U,"initial-inview-percent":a.H}),c=S(a.win,"amp-position-observer.scroll",q({percent:a.H,positionObserverData:d}));a.C.trigger(a.element,"scroll",c,1)}T.prototype.aa=function(a){if(!this.W||!this.S){var b=this.o,d=this.L&&this.L.height;this.D||(this.D=a.viewportRect.height);var c=this.D-a.viewportRect.height,f=0;150>Math.abs(c)?f=c:this.D=null;a.viewportRect=u(a.viewportRect.left,a.viewportRect.top,a.viewportRect.width,a.viewportRect.height+f);this.L=a.viewportRect;d!=a.viewportRect.height&&(this.G=Z(this,this.R),this.V=Z(this,this.M));c=a.viewportRect;c=u(c.left,c.top+this.G,c.width,c.height-this.V-this.G);f=a.positionRect;var e;if(f){var g=e=v(f,c);if("inside"==g)this.o=!0;else{var h=f.height*("top"==g?this.J:this.B);this.o="bottom"==g?f.top<=c.bottom-h:f.bottom>=c.top+h}}else this.o=!1,e=a.relativePos;)),this.C.trigger(this.element,"exit",g,1),this.S=!0);)),this.C.trigger(this.element,"enter",g,1));this.o&&(f&&(g=c.height+f.height-(f.height*this.B+f.height*this.J),c=Math.abs(f.top-this.G-(c.height-f.height*this.B)),this.H=c/g,this.U=g-c),Y(this))}};function na(a){var b=a.element.getAttribute("intersection-ratios");if(b){var d=b.trim().split(" ");a.J=oa(d[0]);a.B=a.J;d[1]&&(a.B=oa(d[1]))}var c=a.element.getAttribute("viewport-margins");c&&(c=c.trim().split(" "),a.R=c[0],a.M=a.R,c[1]&&(a.M=c[1]));a.I=a.element.getAttribute("target")}function X(a){var b=a.I?B().assertElement(a.win.document.getElementById(a.I),"No element found with id:"+a.I):a.element.parentNode;a.win.document.body===b&&(b=a.win.document.documentElement);return b}function Z(a,b){b="number"==typeof b?b+"px":b&&/^\d+(\.\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)?$/.test(b)?/^\d+(\.\d+)?$/.test(b)?b+"px":b:void 0;b=t(b);var d=b;t(d);d=r(/[a-z]+/i.exec(d),"Failed to read units from %s",d)[0];var c=parseFloat(b);c="number"===typeof c&&isFinite(c)?c:void 0;if(!c)return 0;C("px"==d||"vh"==d,"Only pixel or vh are valid as units for exclusion margins: "+b);"vh"==d&&(c=c/100*a.L.height);return c}function oa(a){var b=parseFloat(a);C(0<=b&&1>=b,"Ratios must be a decimal between 0 and 1: "+a);return b}T.prototype.ca=function(){if(this.A){var a=X(this);this.A.unobserve(a);this.A=null}};AMP.registerElement("amp-position-observer",T)}});//# sourceMappingURL=amp-position-observer-0.1.js.map